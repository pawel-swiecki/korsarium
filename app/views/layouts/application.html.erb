<!DOCTYPE html>
<html lang="en" class="wa-theme-awesome wa-palette-bright wa-brand-blue">
  <head>
    <title><%= content_for(:title) || "Korsarium" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <%# Autoload Webawesome via CDN %>
    <link rel="stylesheet" href="https://early.webawesome.com/webawesome@3.0.0-beta.6/dist/styles/webawesome.css" />
    <script type="module" src="https://early.webawesome.com/webawesome@3.0.0-beta.6/dist/webawesome.loader.js"></script>

    <%# Add 'awesome' theme %>
    <link rel="stylesheet" href="https://early.webawesome.com/webawesome@3.0.0-beta.6/dist/styles/themes/awesome.css" />
  </head>

  <body class="center flow box" style="max-inline-size: var(--inline-size-l);">
    <nav class="nav repel">
      <%= link_to image_tag("korsarium-logo-transparent.png", alt: "Korsarium logo", size:"200"), root_path %>

      <div>
        <% if authenticated? %>
          <wa-button pill variant="brand" href="<%= courses_path %>">
            Courses
          </wa-button>

          <wa-dropdown>
            <wa-button pill variant="brand" slot="trigger" with-caret>Settings</wa-button>

            <h3>User</h3>
            <wa-dropdown-item>
              <wa-button appearance="plain" href="<%= settings_user_path %>">Account
                <wa-icon slot="start" name="circle-user"></wa-icon>
              </wa-button>
            </wa-dropdown-item>

            <wa-dropdown-item>
              <wa-button appearance="plain" href="<%= settings_email_path %>">Email
                <wa-icon slot="start" name="envelope"></wa-icon>
              </wa-button>
            </wa-dropdown-item>

            <wa-dropdown-item>
              <wa-button appearance="plain" href="<%= settings_password_path %>">Password
                <wa-icon slot="start" name="key"></wa-icon>
              </wa-button>
            </wa-dropdown-item>

            <wa-dropdown-item>
              <wa-button appearance="plain" href="<%= settings_profile_path %>">Profile
                <wa-icon slot="start" name="address-card"></wa-icon>
              </wa-button>
            </wa-dropdown-item>

            <wa-dropdown-item>
              <wa-button appearance="plain" variant="danger">
                <wa-icon slot="start" name="right-from-bracket"></wa-icon>
                <%= link_to "Log Out", session_path, data: { turbo_method: :delete } %>
              </wa-button>
            </wa-dropdown-item>

            <% if Current.user.admin? %>
              <wa-divider></wa-divider>

              <h4>Korsarium</h4>

              <wa-dropdown-item>
                <wa-button appearance="plain" href="<%= korsarium_users_path %>">Users
                  <wa-icon slot="start" name="address-card"></wa-icon>
                </wa-button>
              </wa-dropdown-item>
            <% end %>
          </wa-dropdown>
        <% else %>
          <wa-button pill variant="brand" href="<%= sign_up_path %>">
            Sign Up
          </wa-button>

          <wa-button pill variant="brand" href="<%= new_session_path %>">
            Log In
          </wa-button>
        <% end %>
      </div>
    </nav>

    <main class="center">
      <%= yield %>
    </main>
  </body>
</html>
